<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hanxi">
<meta name="dcterms.date" content="2025-10-30">
<meta name="description" content="Do large language models truly understand astronomy or just reenact the language of understanding?">

<title>When I asked an LLM to explain a comet‚Äôs orbit ‚Äì Prompts, Dreams, and Me</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1db3f541d99483cdc7a0d9cf38862b2c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Prompts, Dreams, and Me</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/hanxi-guo"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/hanxi-guo-765289301/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">When I asked an LLM to explain a comet‚Äôs orbit</h1>
                  <div>
        <div class="description">
          Do large language models truly understand astronomy or just reenact the language of understanding?
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">prompting</div>
                <div class="quarto-category">News</div>
                <div class="quarto-category">Talk with AI</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Hanxi </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 30, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Recently, I came across a piece of astronomy news that immediately pulled me in ‚Äî the interstellar comet <strong>3I/ATLAS had just reached its perihelion</strong>, the closest point to the Sun in its long, mysterious journey<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. As someone who has always been deeply fascinated by both <strong>science fiction</strong> and <strong>astronomy</strong>, I became curious: <em>How would an LLM explain a scientific story like this ‚Äî one built from formulas, observational limits, and an enormous amount of uncertainty?</em></p>
<p>To explore this question, I asked the model to act as a ‚Äúmiddle-school astronomy teacher‚Äù and explain concepts like perihelion and interstellar objects. Then, I challenged it with several ‚Äúbeyond the textbook‚Äù questions, to see how would it explain and ‚Äúreveal‚Äù something unexpected.</p>
<blockquote class="blockquote">
<p>This experiment was conducted using GPT-5.1 for educational and reflective purposes. The results are for analysis only and do not represent my views about astronomers, NASA, or any research community.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="cover.png" class="img-fluid figure-img"></p>
<figcaption>Image created by Gemini</figcaption>
</figure>
</div>
<section id="experiment" class="level2">
<h2 class="anchored" data-anchor-id="experiment">Experiment</h2>
<p><strong>Prompt</strong>: Explain this news to a curious middle-school student as you are a middle-school astronomy teacher. <a href="https://www.astronomy.com/science/comet-3i-atlas-reaches-perihelion-begins-solar-transit/">Comet 3I/ATLAS reaches perihelion, begins solar transit Now hidden from Earth, the comet is being monitored by a fleet of interplanetary spacecraft during its closest approach to the Sun</a>.Use simple but accurate language.</p>
<p><strong>Response</strong>: (I put the screenshots here since it gave me some pictures of it):</p>
<p>üõ∞Ô∏è Then who is watching it?</p>
<p>Spacecraft! A group of interplanetary spacecraft, including solar observatories like SOHO and STEREO, have cameras that constantly watch the Sun. These spacecraft can see the comet as it swings by, because: ‚Ä¢ they are not on Earth, so their view angle is different ‚Ä¢ their cameras are trained to handle the Sun‚Äôs brightness ‚Ä¢ they take pictures of the area around the Sun to study space weather</p>
<p>So while we can‚Äôt see the comet from here, our robots in space can.</p>
<p>‚∏ª</p>
<details>
<summary>
<b>Click to view full response</b>
</summary>
<p>‚òÑÔ∏è Why is this comet special?</p>
<p>Comet 3I/ATLAS is interstellar ‚Äî meaning it came from outside our solar system. It‚Äôs only the third such comet we‚Äôve ever identified. That makes it kind of like a visitor from another neighborhood passing through our ‚Äúsolar-system town.‚Äù</p>
<p>As it gets close to the Sun: ‚Ä¢ heat makes its ice turn to gas ‚Ä¢ that creates a glowing tail ‚Ä¢ scientists can study its ingredients ‚Ä¢ which helps us learn what other star systems are made of</p>
<p>‚∏ª</p>
<p>üß™ What scientists hope to learn</p>
<p>By observing the comet up close during perihelion, spacecraft can help scientists: ‚Ä¢ study how interstellar comets behave near a star ‚Ä¢ measure what gases and dust it releases ‚Ä¢ compare it with comets that come from our solar system ‚Ä¢ understand what the comet‚Äôs home environment might have been like</p>
<p>It‚Äôs like getting a sample from another solar system‚Äîwithout leaving ours!</p>
</details>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="output1.png" class="img-fluid figure-img"></p>
<figcaption>Screenshot of ChatGPT-5.1 output</figcaption>
</figure>
</div>
<hr>
<p>Now we ask two deeper, reasoning-based questions:</p>
<p><strong>Prompt</strong>: 1. If 3I/ATLAS had twice its current mass, how would that change its perihelion trajectory? 2. Why are scientists still uncertain about its origin even after perihelion?</p>
<p>Give short, structured answers. If something is unknown, say ‚Äúunknown‚Äù and explain why.</p>
<p><strong>Response</strong>:</p>
<p>Here we go‚Äîshort and to the point, teacher mode on üòÑ</p>
<hr>
<ol type="1">
<li>If 3I/ATLAS had twice its current mass‚Ä¶</li>
</ol>
<p>Main effect on trajectory: ‚Ä¢ Its perihelion path would be almost the same. ‚Ä¢ The Sun‚Äôs mass is so huge compared to the comet that doubling the comet‚Äôs mass barely changes the orbit in terms of shape or closest-approach distance.</p>
<p>Small possible differences: ‚Ä¢ The main change might be in non-gravitational effects (like jets of gas pushing on the comet). ‚Ä¢ A more massive comet is a bit harder to ‚Äúpush around,‚Äù so outgassing might change its path slightly less, but the basic trajectory would not dramatically change.</p>
<hr>
<ol start="2" type="1">
<li>Why are scientists still unsure about its origin?</li>
</ol>
<p>Origin star system: ‚Ä¢ Exact birthplace: unknown. ‚Ä¢ To trace it back to a specific star, scientists need extremely precise measurements of: ‚Ä¢ its incoming speed and direction ‚Ä¢ how much its path was changed by outgassing and the Sun‚Äôs gravity ‚Ä¢ the past motions of many nearby stars</p>
<p>Why it stays unknown: 1. Measurement limits: ‚Ä¢ Even tiny errors in the comet‚Äôs velocity or direction grow huge when you try to ‚Äúrewind‚Äù its path over millions of years. 2. Non-gravitational forces: ‚Ä¢ Jets of gas from the comet act like little thrusters. ‚Ä¢ These are hard to model exactly, so its past path becomes fuzzy. 3. Crowded galaxy: ‚Ä¢ Many stars have passed near the region it came from. ‚Ä¢ Several different stars could fit the backward-tracked path within the error bars, so there‚Äôs no single clear parent star.</p>
<p>So: scientists can say ‚Äúit came from outside our solar system,‚Äù but which star system it came from is still unknown because the data and models are not precise enough over such long times.</p>
<hr>
<p>Great! Then what if we make the questions even harder?</p>
<p><strong>Prompt</strong>: Could 3I/ATLAS melt completely during perihelion and reform later as the same object? Explain your reasoning and answer in 2 paragraph.</p>
<p><strong>Response</strong>: Short answer: no, not really. Near perihelion, a comet like 3I/ATLAS doesn‚Äôt ‚Äúmelt‚Äù into a puddle the way ice does on Earth. Instead, its ices sublimate‚Äîthey go straight from solid to gas in the vacuum of space. That gas, plus dust, is blown away by sunlight and the solar wind, forming the coma and tail. If the comet were heated so much that its entire nucleus turned to gas and dust, that material would spread out along its orbit. The particles would be moving at different speeds and directions, so they wouldn‚Äôt stay together in one solid chunk.</p>
<p>Because of that spreading and the Sun constantly pushing on the gas and dust, it‚Äôs extremely unlikely for all that material to later gather back into the same single object. Some bits might clump slightly or form fragments, but they‚Äôd be smaller, irregular pieces, not the original comet. Even if some re-accumulation happened, the new body would have different mass, shape, and structure, so astronomers would treat it as a different object, not ‚Äúthe same comet reborn.‚Äù</p>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>The model quickly settled into the role I assigned it. When I asked it to act as a middle-school astronomy teacher, it did a solid job defining <em>perihelion</em> and <em>interstellar comet</em>, and its explanations were fluent and readable.</p>
<p><strong>It explaint and answered well‚Äìat least it seems like this.</strong></p>
<p>But when we look carefully at it‚Äôs response: When I pressed it with ‚ÄúWhat would happen if the comet were twice as massive?‚Äù, the model offered confident statements about orbital changes, even though such changes depend on parameters it never asked for: velocity, approach angle, and gravitational perturbations. It did not mark these statements as hypothetical or data-dependent; it simply spoke as if the physics were certain. When I asked, ‚ÄúWhy is there still uncertainty even after perihelion?‚Äù, the model produced a stylistic sentence: ‚Äúuncertainty remains because space observations are inherently limited‚Äù, which is true in a general sense but does not actually answer the question. It never explained which observations of 3I/ATLAS are limited, or why this object in particular resists classification. The uncertainty became a rhetorical flourish rather than a scientific explanation.</p>
<p>The model could list plausible-sounding factors and stitch together fragments of textbook language, yet it struggled to separate what is actually known from what is speculative or simply unknown. In other words, it was very good at imitating the language of someone who understands orbital mechanics, and much less good at showing the limits of that understanding. Also, *the model explains, but does not inquire.** It can restate known concepts clearly, yet it does not naturally ask, ‚ÄúWhat evidence supports this?‚Äù or ‚ÄúHow certain are we?‚Äù unless it is explicitly pushed to do so.</p>
</section>
<section id="takeaway" class="level2">
<h2 class="anchored" data-anchor-id="takeaway">Takeaway</h2>
<p>This does not mean LLMs are useless for science communication. In fact, this little experiment shows the opposite: they are remarkably good at translating professional material into understandable language on demand. But it also highlights a quieter risk. Because the model is so fluent, it is easy for me, as a reader, to mistake <em>fluency</em> for <em>understanding</em>, and <em>confident prose</em> for <em>careful reasoning</em>. A real astronomer is trained to live with uncertainty while the model, by contrast, has no stake in whether the comet‚Äôs origin is truly known. It only has a stake in producing something that looks like a good answer. That gap between looking like understanding and actually understanding is exactly where human being still make effort on.</p>
<p>3I/ATLAS may never tell us where it came from, but at least it‚Äôs honest about being mysterious. <em>The LLM, unfortunately, is only honest when I remind it to be.</em> :)</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://science.nasa.gov/solar-system/comets/3i-atlas/">Comet 3I/ATLAS</a><a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/hanxi-guo\.github\.io\/comm4190_F25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>